"0","wc %>% "
"0","  group_by(study) %>% "
"0","  mutate(competent = replace_na(competent, mean(competent, na.rm = TRUE))) %>% "
"0","  group_by(study, name) %>% "
"0","  summarise(warm=mean(warm), competent=mean(competent),.groups = ""drop"") %>%"
"0","  group_by(study) %>%"
"0","  summarize(n_study = n(), "
"0","            correlation = cor(warm, competent),"
"0","            .groups = ""drop"") %>%"
"0","  ungroup()->df_temp"
"0",""
"0","m.cor_wc <- metacor(cor = correlation, "
"0","                 n = n_study,"
"0","                 studlab = study,"
"0","                 data = df_temp,"
"0","                 fixed = FALSE,"
"0","                 random = TRUE,"
"0","                 method.tau = ""REML"","
"0","                 hakn = TRUE)"
"0","m.cor_wc<-update.meta(m.cor_wc, prediction = TRUE)"
"0","rcor<-(exp(2*m.cor_wc$TE.random)-1)/(1+exp(2*m.cor_wc$TE.random))"
"0",""
"0","# table with meta model "
"0","tibble("
"0","  ""variable""=c("""", m.cor_wc$studlab),"
"0","  ""correlation"" = c(rcor, m.cor_wc$cor),"
"0","  ""lower"" = c(m.cor_wc$lower.random, m.cor_wc$lower),"
"0","  ""upper"" = c(m.cor_wc$upper.random,m.cor_wc$upper),"
"0","  ""p-value"" = c(m.cor_wc$pval.random, m.cor_wc$pval),"
"0","  ""SE"" = c(m.cor_wc$seTE.random,m.cor_wc$seTE)) %>%"
"0","  mutate_if(is.numeric, ~round(., 3)) %>%"
"0","  gt(rowname_col = ""variable"") |>"
"0","  tab_spanner("
"0","    label = ""95% CI"","
"0","    columns = c(lower,upper))|>"
"0","  tab_row_group("
"0","    label = ""pooled"","
"0","    rows = 1"
"0","  )%>%"
"0","  tab_row_group("
"0","    label = ""by study"","
"0","    rows = 2:11"
"0","  )%>%"
"0","  tab_footnote("
"0","    footnote = ""Meta-analysis of k = 10 studies with o = 418 observations using inverse variance method. Random effects model with restricted maximum-likelihood estimator for tau^2 and Hartung-Knapp adjustment (df = 8). Confidence intervals for tau^2 and tau estimated using Q-Profile method. Fisher's z transformation used for correlations."""
"0","  ) %>% gtsave(""table.tex"")"
